rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {

    // users : lecture/écriture (hors delete) pour simplifier le MVP
    match /users/{uid} {
      allow read: if true;
      allow create, update: if true;
      allow delete: if false;
    }

    // days/* : lecture/écriture ouvertes pour les dashboards
    match /days/{date} {
      allow read, write: if true;
      match /meta/{doc}       { allow read, write: if true; }
      match /attendance/{doc} { allow read, write: if true; }
      match /metrics/{uid}    { allow read, write: if true; }
    }

    // Par défaut : rien d'autre autorisé
    match /{document=**} { allow read, write: if false; }
  }
}
