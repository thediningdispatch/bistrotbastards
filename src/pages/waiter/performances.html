<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover" />
  <meta name="robots" content="noindex, nofollow" />
  <title>Performances serveur ‚Äî Bistrot Bastards</title>
  <meta name="description" content="Visualise tes performances du jour : satisfaction, ticket moyen, avis Google et produit phare." />
  <link rel="stylesheet" href="../../styles/system7.css" />
  <link rel="stylesheet" href="../../styles/navigation.css" />
  <style>
    :root {
      font-family: "Helvetica Neue", system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      color: #121212;
    }
    body.waiter-perf-page {
      background: #f2f2f2;
      color: inherit;
    }
    .perf-body {
      padding: 1.5rem;
      display: flex;
      flex-direction: column;
      gap: 1.25rem;
    }
    .perf-header {
      background: #fff;
      border: 1px solid #e5e5e5;
      border-radius: 14px;
      padding: 1.5rem;
      display: flex;
      flex-wrap: wrap;
      justify-content: space-between;
      gap: 1rem;
      box-shadow: 0 10px 25px rgba(15, 15, 15, 0.04);
    }
    .perf-header h1 {
      margin: 0 0 0.35rem;
      font-size: clamp(1.5rem, 4vw, 2.1rem);
    }
    .perf-meta {
      margin: 0;
      color: #4a4a4a;
      font-size: 0.95rem;
    }
    .perf-meta strong {
      color: #111;
    }
    .perf-meta .meta-sep {
      margin: 0 0.35rem;
      color: #b0b0b0;
    }
    .perf-actions {
      display: flex;
      align-items: flex-start;
      gap: 0.5rem;
    }
    .perf-refresh {
      border: 1px solid #111;
      background: transparent;
      color: #111;
      padding: 0.5rem 0.9rem;
      border-radius: 999px;
      font-size: 0.9rem;
      cursor: pointer;
      transition: background 0.2s ease, color 0.2s ease;
    }
    .perf-refresh:hover {
      background: #111;
      color: #fff;
    }
    .perf-status {
      font-size: 0.95rem;
      padding: 0.75rem 1rem;
      border-radius: 10px;
      border: 1px solid #e2e2e2;
      background: #fff;
    }
    .perf-status[data-tone="muted"] { color: #6a6a6a; border-style: dashed; }
    .perf-status[data-tone="error"] { color: #b3261e; border-color: #f6d2cf; background: #fff5f4; }
    .perf-status[data-tone="success"] { color: #0d7a43; border-color: #cdebd8; background: #f3fbf6; }
    .perf-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
      gap: 1rem;
    }
    @media (min-width: 640px) {
      .perf-grid {
        grid-template-columns: repeat(2, minmax(0, 1fr));
      }
    }
    @media (min-width: 1100px) {
      .perf-grid {
        grid-template-columns: repeat(4, minmax(0, 1fr));
      }
    }
    .perf-card {
      background: #fff;
      border: 1px solid #e7e7e7;
      border-radius: 14px;
      padding: 1.25rem;
      display: flex;
      flex-direction: column;
      gap: 0.4rem;
      box-shadow: 0 12px 20px rgba(30, 30, 30, 0.05);
    }
    .perf-card header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 0.6rem;
    }
    .perf-label {
      font-weight: 600;
      font-size: 1rem;
    }
    .perf-weight {
      font-size: 0.85rem;
      color: #7d7d7d;
    }
    .perf-score {
      font-size: 2rem;
      font-weight: 700;
      margin: 0.2rem 0;
    }
    .perf-detail,
    .perf-meta-info {
      margin: 0;
      color: #4a4a4a;
      font-size: 0.95rem;
      line-height: 1.4;
    }
    .perf-meta-info {
      color: #6c6c6c;
      font-size: 0.9rem;
    }
    .perf-card-total {
      background: linear-gradient(165deg, #111 0%, #2c2c2c 100%);
      color: #fff;
      border-color: #111;
    }
    .perf-card-total .perf-weight { color: rgba(255, 255, 255, 0.65); }
    .perf-card-total .perf-detail,
    .perf-card-total .perf-meta-info { color: rgba(255, 255, 255, 0.85); }
    @media (min-width: 1100px) {
      .perf-card-total {
        grid-column: span 2;
      }
    }
    .perf-badge {
      display: inline-flex;
      align-items: center;
      gap: 0.3rem;
      padding: 0.15rem 0.6rem;
      border-radius: 999px;
      font-size: 0.8rem;
      font-weight: 600;
      background: #fff7d6;
      color: #7a5300;
      border: 1px solid #f1da92;
      margin-top: 0.25rem;
      width: fit-content;
    }
    .perf-card-total .perf-score {
      font-size: 2.2rem;
    }
  </style>
</head>
<body class="waiter-perf-page">
  <div class="desktop">
    <div class="window">
      <div class="title-bar">
        <div class="window-controls"><span></span><span></span><span></span></div>
        <span class="title-text">Performances</span>
      </div>

      <div class="window-body perf-body" id="app">
        <div id="navHost"></div>

        <section class="perf-header">
          <div>
            <h1>Mes performances du jour</h1>
            <p class="perf-meta">
              Service du <strong id="perfDate">‚Äî</strong>
              <span class="meta-sep">‚Ä¢</span>
              <span><span id="perfUserRole">Serveur</span> : <strong id="perfUserName">‚Äî</strong></span>
            </p>
          </div>
          <div class="perf-actions">
            <button class="perf-refresh" id="perfRefresh" type="button" aria-label="Recharger les performances">‚Üª Actualiser</button>
          </div>
        </section>

        <p id="perfStatus" class="perf-status" role="status" aria-live="polite" data-tone="info">‚è≥ Chargement des performances...</p>

        <div id="perfGrid" class="perf-grid" hidden aria-live="polite">
          <article class="perf-card" aria-labelledby="perfLabelSatisfaction">
            <header>
              <span class="perf-label" id="perfLabelSatisfaction">üíõ Satisfaction</span>
              <span class="perf-weight">40%</span>
            </header>
            <p class="perf-score" id="perfScoreSatisfaction">‚Äî</p>
            <p class="perf-detail" id="perfDetailSatisfaction">En attente des retours clients.</p>
            <p class="perf-meta-info" id="perfMetaSatisfaction"></p>
          </article>

          <article class="perf-card" aria-labelledby="perfLabelTicket">
            <header>
              <span class="perf-label" id="perfLabelTicket">üí∂ Ticket moyen</span>
              <span class="perf-weight">25%</span>
            </header>
            <p class="perf-score" id="perfScoreTicket">‚Äî</p>
            <p class="perf-detail" id="perfDetailTicket">Ticket perso vs resto</p>
            <p class="perf-meta-info" id="perfMetaTicket"></p>
            <span class="perf-badge" id="ticketBadge" hidden>‚≠ê Meilleur ticket du service</span>
          </article>

          <article class="perf-card" aria-labelledby="perfLabelAvis">
            <header>
              <span class="perf-label" id="perfLabelAvis">‚≠ê Avis Google</span>
              <span class="perf-weight">15%</span>
            </header>
            <p class="perf-score" id="perfScoreAvis">‚Äî</p>
            <p class="perf-detail" id="perfDetailAvis">Avis publi√©s / scans</p>
            <p class="perf-meta-info" id="perfMetaAvis"></p>
          </article>

          <article class="perf-card" aria-labelledby="perfLabelProduit">
            <header>
              <span class="perf-label" id="perfLabelProduit">ü•Ç Produit phare</span>
              <span class="perf-weight">20%</span>
            </header>
            <p class="perf-score" id="perfScoreProduit">‚Äî</p>
            <p class="perf-detail" id="perfDetailProduit">Ventes / objectif</p>
            <p class="perf-meta-info" id="perfMetaProduit"></p>
          </article>

          <article class="perf-card perf-card-total" aria-labelledby="perfLabelTotal">
            <header>
              <span class="perf-label" id="perfLabelTotal">üß† Total</span>
              <span class="perf-weight">/10</span>
            </header>
            <p class="perf-score" id="perfScoreTotal">‚Äî</p>
            <p class="perf-detail" id="perfDetailTotal">0,40√óS + 0,25√óT + 0,15√óA + 0,20√óP</p>
            <p class="perf-meta-info">Chaque pilier est plafonn√© √† 10. Bonus ticket si meilleur du service.</p>
          </article>
        </div>
      </div>
    </div>
  </div>

  <script type="module" src="../../scripts/core/navigation.js"></script>
  <script type="module" src="../../scripts/core/auth-guard.js"></script>
  <script type="module" src="../../scripts/pages/waiter-performances.js"></script>
</body>
</html>
