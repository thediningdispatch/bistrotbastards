<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="robots" content="noindex, nofollow" />
  <title>ğŸ¾ DÃ©fi Podium â€” Avis Google</title>
  <meta name="description" content="RÃ©dige ton avis Google en un clic, copie-colle et publie." />
  <link rel="stylesheet" href="system7.css" />
</head>
<body>
  <div class="desktop">
    <div class="menu-bar">
      <span class="menu-item menu-apple">ï£¿</span>
      <span class="menu-item">BoÃ®te Ã  outils Podium</span>
    </div>

    <div class="window">
      <div class="title-bar">
        <div class="window-controls"><span></span><span></span><span></span></div>
        <span class="title-text">DÃ©fi Podium</span>
      </div>

      <div class="window-body" id="app">
        <div class="toolbar" id="reviewLogoBar">
          <a class="btn" href="index.html">â† Accueil</a>
          <h1 class="logo-text">Bistrot Bastards</h1>
        </div>

        <h2>DÃ©fi Podium</h2>
        <p>Aide ton serveur Ã  gagner la bouteille. RÃ©dige ton avis ici, copie et colle-le sur Google.</p>

          <div class="steps">
            <strong>Trois Ã©tapes simples</strong>
            <ol>
              <li>Choisis la personne qui sâ€™est occupÃ©e de toi.</li>
              <li>SÃ©lectionne lâ€™emoji qui correspond Ã  ton expÃ©rience et ajoute un message court.</li>
              <li>Copie, colle sur Google et clique sur publier.</li>
            </ol>
          </div>

          <form id="reviewForm">
            <div>
              <label for="serverSelect">ServeurÂ·se</label>
              <select id="serverSelect" name="server" required>
                <option value="">Qui sâ€™est occupÃ©Â·e de toi ?</option>
                <option value="Jules">ğŸ•º Jules</option>
                <option value="Chloe">ğŸ’ƒ Chloe</option>
              </select>
            </div>

            <div>
              <label>ExpÃ©rience</label>
              <div class="emoji-row" id="moodRow">
                <div class="emoji" data-mood="ğŸ¥²" aria-label="Ã€ amÃ©liorer">ğŸ¥²</div>
                <div class="emoji" data-mood="ğŸ˜‹" aria-label="Bon service">ğŸ˜‹</div>
                <div class="emoji" data-mood="ğŸ¤©" aria-label="Service exceptionnel">ğŸ¤©</div>
              </div>
              <p class="hint-inline">Appuie sur lâ€™emoji qui dÃ©crit le mieux ta visite.</p>
            </div>

            <input type="hidden" name="mood" id="moodInput" />

            <div>
              <label for="commentField">Ton message</label>
              <textarea id="commentField" name="comment" rows="4" placeholder="Partage un mot sur ton expÃ©rience âœï¸"></textarea>
            </div>

            <button class="btn" type="submit">Copier lâ€™avis et continuer</button>
          </form>

          <footer class="footer">
            <p>
              Merci pour ton avis â€” il fait briller notre Ã©quipe.
            </p>
          </footer>
        </div>
      </div>
    </div>
  </div>

  <script type="module" src="main.js"></script>
  <script>
    document.querySelectorAll('.emoji').forEach(emoji => {
      emoji.addEventListener('click', () => {
        document.querySelectorAll('.emoji').forEach(el => el.classList.remove('active'));
        emoji.classList.add('active');
        document.getElementById('moodInput').value = emoji.dataset.mood;
      });
    });

    document.getElementById('reviewForm').addEventListener('submit', async (ev) => {
      ev.preventDefault();
      const data = Object.fromEntries(new FormData(ev.target).entries());
      if (!data.server || !data.mood || !data.comment) {
        alert('Merci de remplir tous les champs âœ¨');
        return;
      }

      try { await navigator.clipboard.writeText(data.comment); }
      catch (err) { console.warn('Clipboard error:', err); }

      const webhookURL = 'https://hook.eu2.make.com/nhx6dn3egqsqx4sg8knx2ycrbhpv7nof';

      try {
        await fetch(webhookURL, {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify(data)
        });
      } catch (err) {
        console.error('âŒ Erreur webhook :', err);
      }

      alert(`ğŸ”¥ Ton avis est copiÃ© !\n\nAide ${data.server} Ã  dÃ©crocher la bouteille ğŸ¾\nğŸ‘‰ Colle ton message sur la page Google Podium et clique sur Â« Publier Â» â­`);
      window.location.href = 'https://search.google.com/local/writereview?placeid=ChIJSQ8zOV1x5kcRqKqGrh0MXk4';
    });
  </script>
  <script type="module" src="auth-guard.js"></script>
</body>
</html>
